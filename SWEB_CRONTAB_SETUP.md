# üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Crontab –¥–ª—è SWEB —Ö–æ—Å—Ç–∏–Ω–≥–∞ (boost113ic)

## ‚ö° –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### üïê –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å crontab
```bash
crontab -e
```

### üìã –®–∞–≥ 2: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –≤—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏:

```bash
# Laravel Queue Worker –¥–ª—è tg_sticap_ru - –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
* * * * * cd tg_sticap_ru && php8.1 artisan queue:work --stop-when-empty --max-time=60 --sleep=3 --tries=3 >> logs/queue-worker.log 2>&1

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–¥–∞—á - –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
*/5 * * * * cd tg_sticap_ru && php8.1 artisan queue:fix-delayed --force >> logs/queue-fix.log 2>&1

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è - –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
*/30 * * * * cd tg_sticap_ru && php8.1 artisan queue:monitor >> logs/queue-monitor.log 2>&1

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ - –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
0 2 * * * find tg_sticap_ru/storage/logs/*.log -type f -mtime +7 -delete 2>/dev/null
```

### üíæ –®–∞–≥ 3: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤—ã–π—Ç–∏
- –ù–∞–∂–º–∏—Ç–µ `Ctrl+X`, –∑–∞—Ç–µ–º `Y`, –∑–∞—Ç–µ–º `Enter`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–∑):
```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd tg_sticap_ru

# –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è –ª–æ–≥–æ–≤
mkdir -p logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ artisan
chmod 755 artisan

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PHP –≤–µ—Ä—Å–∏—é
php8.1 --version

# –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ (–µ—Å–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
php8.1 artisan queue:table

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
php8.1 artisan migrate
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:
```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ª–æ—Ç–µ—Ä–µ–∏
php8.1 artisan lottery:test --quick --user-id=–í–ê–®_TELEGRAM_ID

# –¢–µ—Å—Ç –≤—ã–ø–ª–∞—Ç—ã –≤—ã–∏–≥—Ä—ã—à–µ–π
php8.1 artisan lottery:test-winning-payout --user-id=–í–ê–®_TELEGRAM_ID --amount=10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
php8.1 artisan bot:check-stars-setup --fix

# –¢–µ—Å—Ç –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á (30 —Å–µ–∫—É–Ω–¥)
php8.1 artisan queue:test-timing --seconds=30
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã crontab:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ crontab —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
crontab -l

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –æ—á–µ—Ä–µ–¥–∏
tail -f logs/queue-worker.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏
php8.1 artisan queue:monitor

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
php8.1 artisan stars:manage balance –í–ê–®_TELEGRAM_ID
```

## üìä –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å

### ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ—Ä–µ–¥–∏** - –µ—Å—Ç—å –ª–∏ –∑–∞–¥–∞—á–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ ProcessLotteryResult** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π
3. **–í—ã–ø–ª–∞—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π** - –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º
4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Telegram
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–ø–∏—Å—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ logs/queue-worker.log

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç:
1. **–ó–∞–≤–∏—Å—à–∏–µ –∑–∞–¥–∞—á–∏** - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö jobs
2. **–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏** - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
3. **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á** - —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥–∏
php8.1 artisan queue:monitor

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–∞
tail -50 logs/queue-worker.log

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/queue-worker.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏
grep "ERROR\|FAILED" logs/queue-worker.log

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
grep "processed\|completed" logs/queue-worker.log | tail -10
```

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ crontab —Ä–∞–±–æ—Ç–∞–µ—Ç
crontab -l

# 2. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
cd tg_sticap_ru && php8.1 artisan queue:work --stop-when-empty --max-time=10

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la artisan
chmod 755 artisan

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
php8.1 artisan migrate:status

# 5. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–¥–∞—á—É
php8.1 artisan queue:test-timing --seconds=10
```

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ crontab:
- ‚úÖ –õ–æ—Ç–µ—Ä–µ—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ 24/7
- ‚úÖ –†–æ–∑—ã–≥—Ä—ã—à–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏
- ‚úÖ –í—ã–∏–≥—Ä—ã—à–∏ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –∑–∞—á–∏—Å–ª—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- ‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f logs/queue-worker.log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ crontab —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `crontab -l`
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤—Ä—É—á–Ω—É—é
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º –ø—Ä–æ–µ–∫—Ç–∞
